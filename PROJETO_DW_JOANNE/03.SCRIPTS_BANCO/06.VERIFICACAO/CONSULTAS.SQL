-- Qual a quantidade de disciplinas que um professor pega por período?
SELECT COUNT(DISTINCT D.COD) AS QTD_DISCIPLINAS, P.NOME_PROFESSOR 
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_DISCIPLINA D 
ON D.ID_DISCIPLINA = F.ID_DISCIPLINA
JOIN DIM_PROFESSOR P 
ON P.ID_PROFESSOR = F.ID_PROFESSOR
GROUP BY P.NOME_PROFESSOR

-- Qual a taxa de reprovação por período?
SELECT T.ANO, T.SEMESTRE, SUM(F.NUM_REPROVADOS) AS QTD_REPROVADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_TEMPO T
ON T.ID_TEMPO = F.ID_TEMPO
GROUP BY T.ANO, T.SEMESTRE
ORDER BY T.ANO, T.SEMESTRE
 
-- Qual a taxa de aprovação por período?
SELECT T.ANO, T.SEMESTRE, SUM(F.NUM_APROVADOS) AS QTD_APROVADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_TEMPO T
ON T.ID_TEMPO = F.ID_TEMPO
GROUP BY T.ANO, T.SEMESTRE
ORDER BY T.ANO, T.SEMESTRE

-- Qual a taxa de trancamento por período?
SELECT T.ANO, T.SEMESTRE, SUM(F.NUM_TRANCADOS) AS QTD_TRANCADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_TEMPO T
ON T.ID_TEMPO = F.ID_TEMPO
GROUP BY T.ANO, T.SEMESTRE
ORDER BY T.ANO, T.SEMESTRE

-- Qual a taxa de reprovação por professor?
SELECT P.NOME_PROFESSOR, SUM(F.NUM_REPROVADOS) AS QTD_REPROVADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_PROFESSOR P
ON P.ID_PROFESSOR = F.ID_PROFESSOR
GROUP BY P.NOME_PROFESSOR

-- Qual a taxa de aprovação por professor?
SELECT P.NOME_PROFESSOR, SUM(F.NUM_APROVADOS) AS QTD_APROVADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_PROFESSOR P
ON P.ID_PROFESSOR = F.ID_PROFESSOR
GROUP BY P.NOME_PROFESSOR

-- Qual a taxa de trancamento por professor?
SELECT P.NOME_PROFESSOR, SUM(F.NUM_TRANCADOS) AS QTD_TRANCADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_PROFESSOR P
ON P.ID_PROFESSOR = F.ID_PROFESSOR
GROUP BY P.NOME_PROFESSOR

-- Qual a disciplina que mais reprova?
SELECT P.NOME_PROFESSOR, SUM(F.NUM_TRANCADOS) AS QTD_TRANCADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_PROFESSOR P
ON P.ID_PROFESSOR = F.ID_PROFESSOR
GROUP BY P.NOME_PROFESSOR

-- Qual a disciplina que mais aprova?
SELECT D.NOME_DISCIPLINA, SUM(F.NUM_APROVADOS) FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_DISCIPLINA D
ON D.ID_DISCIPLINA = F.ID_DISCIPLINA
GROUP BY D.NOME_DISCIPLINA
ORDER BY SUM(F.NUM_APROVADOS) DESC

-- Qual a disciplina que tem maior taxa de trancamento?
SELECT D.NOME_DISCIPLINA, SUM(F.NUM_TRANCADOS) AS QTD_TRANCADOS, (SUM(F.NUM_APROVADOS) + SUM(F.NUM_REPROVADOS) + SUM(F.NUM_TRANCADOS)) AS QTD_ALUNOS_TOTAIS 
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_DISCIPLINA D
ON D.ID_DISCIPLINA = F.ID_DISCIPLINA
GROUP BY D.NOME_DISCIPLINA
ORDER BY SUM(F.NUM_TRANCADOS) DESC

-- Qual a disciplina que tem maior taxa de aprovamento por turno?
SELECT D.NOME_DISCIPLINA, T.NOME_TURNO, SUM(F.NUM_APROVADOS) AS QTD_APROVADOS 
FROM FATO_DIARIO_ACADEMICO F
JOIN DIM_TURNO T
ON T.ID_TURNO = F.ID_TURNO
JOIN DIM_DISCIPLINA D
ON D.ID_DISCIPLINA = F.ID_DISCIPLINA
WHERE D.NOME_DISCIPLINA = 'CALCULO I'
GROUP BY D.NOME_DISCIPLINA, T.NOME_TURNO
ORDER BY SUM(F.NUM_APROVADOS) DESC